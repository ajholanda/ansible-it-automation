---
- hosts: localhost
  vars:
    myvar: "My Variable"

  tasks:
  # - name: Tarefa
  #   debug: msg="Texto em aberto'

  # - name: Tarefa
  #   debug: msg="{{ myvar }"

  # - name: Tarefa
  # debug: msg="Texto ok"

  # - name: Tentando dar um ping
  #   pong:

  # - name: Copia o arquivo de inventário
  #   copy:
  #     path: hosts.ini
  #     dest: /etc/ansible/hosts

  - name: Comete erro
    command: /bin/false
    tags: err0

  - name: Tenta listar arquivo que não existe
    command: ls /tmp/fooo.txt
    tags: err1

  - name: Ignora o erro
    command: /bin/false
    ignore_errors: true
    tags: err2

  - name: Não interpreta false como erro
    command: /bin/false
    register: status
    failed_when: status.rc != 1
    tags: err3
  
  - name: Arquivo não deve existir
    command: ls /tmp/passwd
    register: status
    failed_when: 
      - status.rc != 0
      - '"No such" not in status.stderr'
    tags: err4

  - name: Checa conectividade
    command: ping -c 1 web.example.net
    register: status
    failed_when: >
      status.rc != 0
      or "100% packet loss" in status.stdout
    tags: err5
